<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategic Planner PWA</title>
    
    <link rel="manifest" id="manifest-placeholder">
    <meta name="theme-color" content="#1e293b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        @media print {
            body * { visibility: hidden; }
            .printable-content, .printable-content * { visibility: visible; }
            .printable-content { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; border: none; }
            .no-print { display: none !important; }
        }

        .input-field {
            @apply w-full px-4 py-2 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all text-sm;
        }
        .btn-primary {
            @apply flex items-center justify-center px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all font-semibold shadow-sm disabled:opacity-50;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        const Icon = ({ path, size = 20, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const Icons = {
            LayoutDashboard: (props) => <Icon {...props} path={<><rect width="7" height="9" x="3" y="3" rx="1" /><rect width="7" height="5" x="14" y="3" rx="1" /><rect width="7" height="9" x="14" y="12" rx="1" /><rect width="7" height="5" x="3" y="16" rx="1" /></>} />,
            ClipboardList: (props) => <Icon {...props} path={<><rect width="8" height="4" x="8" y="2" rx="1" ry="1" /><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" /><path d="M12 11h4" /><path d="M12 16h4" /><path d="M8 11h.01" /><path d="M8 16h.01" /></>} />,
            Users: (props) => <Icon {...props} path={<><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></>} />,
            Target: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></>} />,
            PieChart: (props) => <Icon {...props} path={<><path d="M21.21 15.89A10 10 0 1 1 8 2.83" /><path d="M22 12A10 10 0 0 0 12 2v10z" /></>} />,
            FileText: (props) => <Icon {...props} path={<><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z" /><path d="M14 2v4a2 2 0 0 0 2 2h4" /><path d="M10 9H8" /><path d="M16 13H8" /><path d="M16 17H8" /></>} />,
            Plus: (props) => <Icon {...props} path={<><path d="M5 12h14" /><path d="M12 5v14" /></>} />,
            Trash2: (props) => <Icon {...props} path={<><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" x2="10" y1="11" y2="17" /><line x1="14" x2="14" y1="11" y2="17" /></>} />,
            Pencil: (props) => <Icon {...props} path={<><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" /><path d="m15 5 4 4" /></>} />,
            Menu: (props) => <Icon {...props} path={<><line x1="4" x2="20" y1="12" y2="12" /><line x1="4" x2="20" y1="6" y2="6" /><line x1="4" x2="20" y1="18" y2="18" /></>} />,
            X: (props) => <Icon {...props} path={<><path d="M18 6 6 18" /><path d="m6 6 12 12" /></>} />,
            Download: (props) => <Icon {...props} path={<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></>} />,
            DollarSign: (props) => <Icon {...props} path={<><line x1="12" x2="12" y1="2" y2="22" /><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" /></>} />,
            TrendingUp: (props) => <Icon {...props} path={<><polyline points="22 7 13.5 15.5 8.5 10.5 2 17" /><polyline points="16 7 22 7 22 13" /></>} />,
            AlertTriangle: (props) => <Icon {...props} path={<><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><line x1="12" x2="12" y1="9" y2="13" /><line x1="12" x2="12.01" y1="17" y2="17" /></>} />,
            Activity: (props) => <Icon {...props} path={<><path d="M22 12h-4l-3 9L9 3l-3 9H2" /></>} />,
            BookOpen: (props) => <Icon {...props} path={<><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></>} />,
            ShieldCheck: (props) => <Icon {...props} path={<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10" /><path d="m9 12 2 2 4-4" /></>} />
        };

        const DataService = {
            get: (key) => JSON.parse(localStorage.getItem(key)) || [],
            set: (key, data) => localStorage.setItem(key, JSON.stringify(data)),
            add: (collection, item) => {
                const current = DataService.get(collection);
                const newItem = { ...item, id: Date.now().toString(), createdAt: new Date().toISOString() };
                const updated = [newItem, ...current];
                DataService.set(collection, updated);
                return updated;
            },
            update: (collection, id, updates) => {
                const current = DataService.get(collection);
                const updated = current.map(item => item.id === id ? { ...item, ...updates } : item);
                DataService.set(collection, updated);
                return updated;
            },
            delete: (collection, id) => {
                const current = DataService.get(collection);
                const updated = current.filter(item => item.id !== id);
                DataService.set(collection, updated);
                return updated;
            }
        };

        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isSidebarOpen, setIsSidebarOpen] = useState(false);
            
            const [paps, setPaps] = useState([]);
            const [team, setTeam] = useState([]);
            const [swot, setSwot] = useState([]);
            const [bsc, setBsc] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                setPaps(DataService.get('strat_paps'));
                setTeam(DataService.get('strat_team'));
                setSwot(DataService.get('strat_swot'));
                setBsc(DataService.get('strat_bsc'));
                setLoading(false);
            }, []);

            const stats = useMemo(() => ({
                totalBudget: paps.reduce((acc, curr) => acc + (parseFloat(curr.budget) || 0), 0),
                totalProjects: paps.length,
                teamSize: team.length,
                completionRate: paps.length > 0 ? Math.round((paps.filter(p => p.status === 'Completed').length / paps.length) * 100) : 0
            }), [paps, team]);

            const handleNav = (tab) => {
                setActiveTab(tab);
                setIsSidebarOpen(false);
                window.scrollTo(0,0);
            };

            if (loading) return <div className="flex items-center justify-center h-screen">Loading...</div>;

            return (
                <div className="flex h-screen bg-slate-100 overflow-hidden">
                    <aside className={`fixed inset-y-0 left-0 z-50 w-64 bg-slate-900 text-white transform transition-transform duration-300 ${isSidebarOpen ? 'translate-x-0' : '-translate-x-full'} md:relative md:translate-x-0`}>
                        <div className="p-6 border-b border-slate-700 flex justify-between items-center">
                            <div><h1 className="text-xl font-bold text-blue-400">TESDA (WS/HRDC)</h1><p className="text-xs text-slate-400">Strat Planner 1.0</p></div>
                            <button onClick={() => setIsSidebarOpen(false)} className="md:hidden text-slate-400"><Icons.X /></button>
                        </div>
                        <nav className="p-4 space-y-2">
                            <NavButton active={activeTab === 'dashboard'} onClick={() => handleNav('dashboard')} icon={<Icons.LayoutDashboard />}>Dashboard</NavButton>
                            <NavButton active={activeTab === 'swot'} onClick={() => handleNav('swot')} icon={<Icons.Target />}>SWOT Analysis</NavButton>
                            <NavButton active={activeTab === 'bsc'} onClick={() => handleNav('bsc')} icon={<Icons.PieChart />}>Balanced Scorecard</NavButton>
                            <NavButton active={activeTab === 'paps'} onClick={() => handleNav('paps')} icon={<Icons.ClipboardList />}>PAPs Management</NavButton>
                            <NavButton active={activeTab === 'team'} onClick={() => handleNav('team')} icon={<Icons.Users />}>Team & Governance</NavButton>
                            <NavButton active={activeTab === 'report'} onClick={() => handleNav('report')} icon={<Icons.FileText />}>Strategic Plan View</NavButton>
                        </nav>
                    </aside>

                    <main className="flex-1 overflow-auto">
                        <header className="md:hidden bg-white p-4 shadow-sm flex items-center justify-between sticky top-0 z-20">
                            <h2 className="font-semibold text-sm">TESDA (WS/HRDC)</h2>
                            <button onClick={() => setIsSidebarOpen(true)}><Icons.Menu /></button>
                        </header>
                        <div className="p-6 md:p-10 max-w-7xl mx-auto pb-20">
                            {activeTab === 'dashboard' && <DashboardView stats={stats} paps={paps} swot={swot} bsc={bsc} />}
                            {activeTab === 'paps' && <PapsManager paps={paps} onAdd={(v)=>setPaps(DataService.add('strat_paps',v))} onUpdate={(id,v)=>setPaps(DataService.update('strat_paps',id,v))} onDelete={(id)=>setPaps(DataService.delete('strat_paps',id))} />}
                            {activeTab === 'team' && <TeamManager team={team} onAdd={(v)=>setTeam(DataService.add('strat_team',v))} onUpdate={(id,v)=>setTeam(DataService.update('strat_team',id,v))} onDelete={(id)=>setTeam(DataService.delete('strat_team',id))} />}
                            {activeTab === 'swot' && <SwotManager swot={swot} onAdd={(v)=>setSwot(DataService.add('strat_swot',v))} onUpdate={(id,v)=>setSwot(DataService.update('strat_swot',id,v))} onDelete={(id)=>setSwot(DataService.delete('strat_swot',id))} />}
                            {activeTab === 'bsc' && <BscManager bsc={bsc} swot={swot} onAdd={(v)=>setBsc(DataService.add('strat_bsc',v))} onUpdate={(id,v)=>setBsc(DataService.update('strat_bsc',id,v))} onDelete={(id)=>setBsc(DataService.delete('strat_bsc',id))} />}
                            {activeTab === 'report' && <StrategicPlanReport paps={paps} team={team} swot={swot} bsc={bsc} />}
                        </div>
                    </main>
                </div>
            );
        }

        const NavButton = ({ active, onClick, icon, children }) => (
            <button onClick={onClick} className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all ${active ? 'bg-blue-600 text-white shadow-md' : 'text-slate-300 hover:bg-slate-800'}`}>
                {icon}<span className="font-medium">{children}</span>
            </button>
        );

        const DashboardView = ({ stats, paps, swot, bsc }) => (
            <div className="space-y-6">
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <StatCard title="Budget Requirement" value={new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' }).format(stats.totalBudget)} icon={<Icons.DollarSign className="text-emerald-500" />} />
                    <StatCard title="Planned PAPs" value={stats.totalProjects} icon={<Icons.ClipboardList className="text-blue-500" />} />
                    <StatCard title="SWOT Insights" value={swot.length} icon={<Icons.Target className="text-purple-500" />} />
                    <StatCard title="BSC Objectives" value={bsc.length} icon={<Icons.PieChart className="text-orange-500" />} />
                </div>
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 className="font-bold mb-4">Budget by Unit</h3>
                        {Array.from(new Set(paps.map(p => p.unit))).map(unit => {
                            const total = paps.filter(p => p.unit === unit).reduce((s,p)=>s+parseFloat(p.budget||0),0);
                            return <div key={unit} className="mb-2 flex justify-between text-sm"><span>{unit}</span><span className="font-bold">{total.toLocaleString()}</span></div>;
                        })}
                    </div>
                </div>
            </div>
        );

        const StatCard = ({ title, value, icon }) => (
            <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex justify-between items-center">
                <div><p className="text-sm text-slate-500">{title}</p><h3 className="text-xl font-bold">{value}</h3></div>
                <div className="p-3 bg-slate-50 rounded-lg">{icon}</div>
            </div>
        );

        const PapsManager = ({ paps, onAdd, onUpdate, onDelete }) => {
            const [form, setForm] = useState({ unit: '', name: '', pap: '', kpi: '', target: '', timeline: '', budget: '', accountable: '' });
            const [editing, setEditing] = useState(null);
            const formRef = useRef();

            const submit = (e) => {
                e.preventDefault();
                editing ? onUpdate(editing, form) : onAdd(form);
                setForm({ unit: '', name: '', pap: '', kpi: '', target: '', timeline: '', budget: '', accountable: '' });
                setEditing(null);
            };

            const edit = (p) => { setEditing(p.id); setForm(p); formRef.current.scrollIntoView({ behavior: 'smooth' }); };

            return (
                <div className="space-y-6">
                    <div ref={formRef} className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 className="font-bold mb-4 text-blue-800">{editing ? 'Edit PAP' : 'New PAP Entry'}</h3>
                        <form onSubmit={submit} className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <input className="input-field" placeholder="Unit" value={form.unit} onChange={e=>setForm({...form, unit: e.target.value})} required />
                            <input className="input-field" placeholder="Submitter" value={form.name} onChange={e=>setForm({...form, name: e.target.value})} required />
                            <input className="input-field md:col-span-2" placeholder="PAP" value={form.pap} onChange={e=>setForm({...form, pap: e.target.value})} required />
                            <input className="input-field md:col-span-2" placeholder="KPI" value={form.kpi} onChange={e=>setForm({...form, kpi: e.target.value})} required />
                            <input className="input-field" placeholder="Target" value={form.target} onChange={e=>setForm({...form, target: e.target.value})} required />
                            <input className="input-field" placeholder="Timeline" value={form.timeline} onChange={e=>setForm({...form, timeline: e.target.value})} required />
                            <input className="input-field" type="number" placeholder="Budget" value={form.budget} onChange={e=>setForm({...form, budget: e.target.value})} required />
                            <input className="input-field" placeholder="Accountable" value={form.accountable} onChange={e=>setForm({...form, accountable: e.target.value})} required />
                            <div className="md:col-span-4 flex justify-end space-x-2">
                                {editing && <button type="button" onClick={()=>{setEditing(null); setForm({ unit: '', name: '', pap: '', kpi: '', target: '', timeline: '', budget: '', accountable: '' });}} className="px-4 py-2 text-slate-500">Cancel</button>}
                                <button type="submit" className="btn-primary">{editing ? 'Update PAP' : 'Add PAP'}</button>
                            </div>
                        </form>
                    </div>
                    <div className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-x-auto">
                        <table className="w-full text-sm text-left">
                            <thead className="bg-slate-50 border-b"><tr><th className="p-4">Unit</th><th className="p-4">PAP</th><th className="p-4">KPI/Target</th><th className="p-4 text-right">Budget</th><th className="p-4 text-right">Action</th></tr></thead>
                            <tbody className="divide-y">
                                {paps.map(p => (
                                    <tr key={p.id} className="hover:bg-slate-50">
                                        <td className="p-4 font-medium">{p.unit}</td>
                                        <td className="p-4"><div className="font-bold">{p.pap}</div><div className="text-xs text-slate-500">{p.accountable}</div></td>
                                        <td className="p-4"><div>{p.kpi}</div><div className="text-xs text-blue-600 font-bold">{p.target}</div></td>
                                        <td className="p-4 text-right font-mono">{parseFloat(p.budget||0).toLocaleString()}</td>
                                        <td className="p-4 text-right space-x-2">
                                            <button onClick={()=>edit(p)} className="text-blue-500"><Icons.Pencil size={16}/></button>
                                            <button onClick={()=>onDelete(p.id)} className="text-red-500"><Icons.Trash2 size={16}/></button>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        const TeamManager = ({ team, onAdd, onUpdate, onDelete }) => {
            const [form, setForm] = useState({ name: '', designation: '', functions: '' });
            const [editing, setEditing] = useState(null);
            const formRef = useRef();

            const submit = (e) => {
                e.preventDefault();
                editing ? onUpdate(editing, form) : onAdd(form);
                setForm({ name: '', designation: '', functions: '' });
                setEditing(null);
            };

            const edit = (m) => { setEditing(m.id); setForm(m); formRef.current.scrollIntoView({ behavior: 'smooth' }); };

            return (
                <div className="space-y-6">
                    <div ref={formRef} className="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 className="font-bold mb-4">{editing ? 'Edit Team Member' : 'Add Team Member'}</h3>
                        <form onSubmit={submit} className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input className="input-field" placeholder="Name" value={form.name} onChange={e=>setForm({...form, name: e.target.value})} required />
                            <input className="input-field" placeholder="Designation" value={form.designation} onChange={e=>setForm({...form, designation: e.target.value})} required />
                            <input className="input-field" placeholder="Functions" value={form.functions} onChange={e=>setForm({...form, functions: e.target.value})} required />
                            <div className="md:col-span-3 flex justify-end space-x-2">
                                {editing && <button type="button" onClick={()=>{setEditing(null); setForm({name:'', designation:'', functions:''});}} className="px-4 py-2">Cancel</button>}
                                <button type="submit" className="btn-primary">{editing ? 'Update' : 'Add'}</button>
                            </div>
                        </form>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        {team.map(m => (
                            <div key={m.id} className="bg-white p-4 rounded-xl border flex justify-between items-start group">
                                <div><div className="font-bold">{m.name}</div><div className="text-xs text-blue-600 font-bold uppercase">{m.designation}</div><p className="text-sm mt-2 text-slate-600">{m.functions}</p></div>
                                <div className="flex space-x-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                    <button onClick={()=>edit(m)} className="text-blue-400"><Icons.Pencil size={16}/></button>
                                    <button onClick={()=>onDelete(m.id)} className="text-red-400"><Icons.Trash2 size={16}/></button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const SwotManager = ({ swot, onAdd, onUpdate, onDelete }) => {
            const [form, setForm] = useState({ type: 'Strength', description: '' });
            const [editing, setEditing] = useState(null);
            const formRef = useRef();

            const submit = (e) => {
                e.preventDefault();
                editing ? onUpdate(editing, form) : onAdd(form);
                setForm({ ...form, description: '' });
                setEditing(null);
            };

            const edit = (s) => { setEditing(s.id); setForm(s); formRef.current.scrollIntoView({ behavior: 'smooth' }); };

            const displayLabel = (type) => type === 'Opportunity' ? 'Opportunities' : `${type}s`;

            return (
                <div className="space-y-6">
                    <div ref={formRef} className="bg-white p-6 rounded-xl border">
                        <form onSubmit={submit} className="flex gap-4">
                            <select className="input-field w-40" value={form.type} onChange={e=>setForm({...form, type: e.target.value})}>
                                {['Strength', 'Weakness', 'Opportunity', 'Threat'].map(t=><option key={t} value={t}>{t === 'Opportunity' ? 'Opportunity' : t}</option>)}
                            </select>
                            <input className="input-field flex-1" placeholder="Describe SWOT item..." value={form.description} onChange={e=>setForm({...form, description: e.target.value})} required />
                            <button type="submit" className="btn-primary">{editing ? 'Update' : 'Add'}</button>
                            {editing && <button type="button" onClick={()=>{setEditing(null); setForm({type:'Strength', description:''});}} className="px-4">X</button>}
                        </form>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {['Strength', 'Weakness', 'Opportunity', 'Threat'].map(type => (
                            <div key={type} className="bg-white p-5 rounded-xl border min-h-[150px]">
                                <h4 className="font-bold border-b pb-2 mb-3">{displayLabel(type)}</h4>
                                <ul className="space-y-2">
                                    {swot.filter(s => s.type === type).map(s => (
                                        <li key={s.id} className="p-2 bg-slate-50 border rounded text-sm flex justify-between items-center group">
                                            <span>{s.description}</span>
                                            <div className="flex space-x-1 opacity-0 group-hover:opacity-100">
                                                <button onClick={()=>edit(s)} className="text-blue-500"><Icons.Pencil size={14}/></button>
                                                <button onClick={()=>onDelete(s.id)} className="text-red-500"><Icons.X size={14}/></button>
                                            </div>
                                        </li>
                                    ))}
                                </ul>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const BscManager = ({ bsc, swot, onAdd, onUpdate, onDelete }) => {
            const [form, setForm] = useState({ perspective: 'Stakeholder', objective: '', measure: '', relatedSwot: '' });
            const [editing, setEditing] = useState(null);
            const formRef = useRef();

            const submit = (e) => {
                e.preventDefault();
                editing ? onUpdate(editing, form) : onAdd(form);
                setForm({ perspective: 'Stakeholder', objective: '', measure: '', relatedSwot: '' });
                setEditing(null);
            };

            const edit = (b) => { setEditing(b.id); setForm(b); formRef.current.scrollIntoView({ behavior: 'smooth' }); };

            return (
                <div className="space-y-6">
                    <div ref={formRef} className="bg-white p-6 rounded-xl border">
                        <h3 className="font-bold mb-4">{editing ? 'Edit Objective' : 'New Strategic Objective'}</h3>
                        <form onSubmit={submit} className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <select className="input-field" value={form.perspective} onChange={e=>setForm({...form, perspective: e.target.value})}>
                                {['Stakeholder', 'Internal Process', 'Learning & Growth', 'Financial'].map(p=><option key={p} value={p}>{p}</option>)}
                            </select>
                            <select className="input-field" value={form.relatedSwot} onChange={e=>setForm({...form, relatedSwot: e.target.value})}>
                                <option value="">Link to SWOT (Optional)</option>
                                {swot.map(s => <option key={s.id} value={s.description}>{s.type}: {s.description.substring(0,30)}</option>)}
                            </select>
                            <input className="input-field md:col-span-2" placeholder="Strategic Objective" value={form.objective} onChange={e=>setForm({...form, objective: e.target.value})} required />
                            <input className="input-field md:col-span-2" placeholder="Key Performance Measure" value={form.measure} onChange={e=>setForm({...form, measure: e.target.value})} required />
                            <div className="md:col-span-2 flex justify-end space-x-2">
                                {editing && <button type="button" onClick={()=>{setEditing(null); setForm({perspective:'Stakeholder', objective:'', measure:'', relatedSwot:''});}} className="px-4">Cancel</button>}
                                <button type="submit" className="btn-primary">{editing ? 'Update' : 'Add'}</button>
                            </div>
                        </form>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {['Stakeholder', 'Internal Process', 'Learning & Growth', 'Financial'].map(p => (
                            <div key={p} className="bg-white p-5 rounded-xl border">
                                <h4 className="font-bold mb-3 text-slate-700">{p}</h4>
                                <div className="space-y-2">
                                    {bsc.filter(b => b.perspective === p).map(b => (
                                        <div key={b.id} className="p-3 bg-slate-50 border rounded group relative">
                                            <div className="font-bold text-sm">{b.objective}</div>
                                            <div className="text-xs text-slate-500 italic mt-1">Measure: {b.measure}</div>
                                            <div className="absolute top-2 right-2 flex space-x-2 opacity-0 group-hover:opacity-100">
                                                <button onClick={()=>edit(b)} className="text-blue-500"><Icons.Pencil size={14}/></button>
                                                <button onClick={()=>onDelete(b.id)} className="text-red-500"><Icons.Trash2 size={14}/></button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const StrategicPlanReport = ({ paps, team, swot, bsc }) => (
            <div className="bg-white p-10 shadow-lg printable-content mx-auto max-w-5xl">
                <div className="text-center border-b-2 border-slate-900 pb-6 mb-8">
                    <h1 className="text-3xl font-bold uppercase tracking-tight">TESDA (WS/HRDC) Strategic Plan</h1>
                    <p className="text-slate-500 text-lg">Strategic Trajectory 2026-2030</p>
                </div>
                <section className="mb-8">
                    <h2 className="text-xl font-bold mb-4 border-l-4 border-blue-600 pl-3">Strategy Map</h2>
                    {['Stakeholder', 'Internal Process', 'Learning & Growth', 'Financial'].map(p => (
                        <div key={p} className="mb-2 p-3 border rounded">
                            <span className="font-bold w-40 inline-block text-sm">{p}</span>
                            <div className="inline-block align-top">
                                {bsc.filter(b=>b.perspective===p).map(b=><div key={b.id} className="text-xs mb-1">â€¢ {b.objective} ({b.measure})</div>)}
                            </div>
                        </div>
                    ))}
                </section>
                <section className="mb-8">
                    <h2 className="text-xl font-bold mb-4 border-l-4 border-blue-600 pl-3">SWOT Profile</h2>
                    <div className="grid grid-cols-2 gap-4">
                        {['Strength', 'Weakness', 'Opportunity', 'Threat'].map(t => (
                            <div key={t} className="p-4 border bg-slate-50 rounded">
                                <h3 className="font-bold text-sm mb-2">{t === 'Opportunity' ? 'Opportunities' : `${t}s`}</h3>
                                {swot.filter(s=>s.type===t).map(s=><div key={s.id} className="text-xs mb-1">- {s.description}</div>)}
                            </div>
                        ))}
                    </div>
                </section>
                <section>
                    <h2 className="text-xl font-bold mb-4 border-l-4 border-blue-600 pl-3">Program of Activities</h2>
                    <table className="w-full text-[10px] border-collapse">
                        <thead><tr className="bg-slate-100 border">
                            <th className="p-1 border text-left">Unit</th><th className="p-1 border text-left">PAP</th><th className="p-1 border text-left">Target</th><th className="p-1 border text-right">Budget</th>
                        </tr></thead>
                        <tbody>
                            {paps.map(p => (
                                <tr key={p.id} className="border">
                                    <td className="p-1 border">{p.unit}</td><td className="p-1 border">{p.pap}</td><td className="p-1 border">{p.target}</td><td className="p-1 border text-right">{parseFloat(p.budget||0).toLocaleString()}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </section>
                <div className="mt-8 flex justify-end no-print">
                    <button onClick={()=>window.print()} className="btn-primary">Print Document</button>
                </div>
            </div>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
